---
phase: 22-migration-cleanup
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - Dispatch/Views/Skills/SkillsSidePanel.swift
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "SkillsSidePanel no longer shows Terminal.app permission alerts"
    - "Terminal matching removed (embedded terminal auto-targets active session)"
  artifacts:
    - path: "Dispatch/Views/Skills/SkillsSidePanel.swift"
      provides: "Cleaned up skills UI"
      pattern: "!.*TerminalService"
  key_links:
    - from: "SkillsSidePanel"
      to: "no TerminalService"
      via: "removed imports/calls"
      pattern: "!.*TerminalService"
---

<objective>
Remove Terminal.app permission UI from SkillsSidePanel

Purpose: SkillsSidePanel still shows permission alerts for Terminal.app automation and accessibility, and loads Terminal.app windows for matching. Since embedded terminal is now the standard, this UI is misleading and should be removed.

Output: Clean skills panel without Terminal.app permission prompts or window listing.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/22-migration-cleanup/22-VERIFICATION.md
@Dispatch/Views/Skills/SkillsSidePanel.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Terminal.app permission alerts</name>
  <files>Dispatch/Views/Skills/SkillsSidePanel.swift</files>
  <action>
1. Find and remove the permission alert state variables:
   - `@State private var showingAutomationPermissionAlert = false`
   - `@State private var showingAccessibilityPermissionAlert = false`

2. Remove the .alert modifiers for Terminal permissions (around lines 98-117):
   ```swift
   .alert("Terminal Permission Required", isPresented: $showingAutomationPermissionAlert) { ... }
   .alert("Accessibility Permission Required", isPresented: $showingAccessibilityPermissionAlert) { ... }
   ```

3. Remove the TerminalService.shared.openAutomationSettings() call (line 101)
4. Remove the TerminalService.shared.openAccessibilitySettings() call (line 111)

Why: These permission prompts are for Terminal.app automation which is no longer used. Keeping them would confuse users into granting unnecessary permissions.
  </action>
  <verify>
Build succeeds: `xcodebuild -scheme Dispatch -destination 'platform=macOS' build 2>&1 | tail -20`
No permission alerts: `grep -n "showingAutomationPermissionAlert\|showingAccessibilityPermissionAlert" Dispatch/Views/Skills/SkillsSidePanel.swift`
  </verify>
  <done>
Permission alert state variables removed
Permission alert modifiers removed
openAutomationSettings/openAccessibilitySettings calls removed
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove Terminal.app window loading</name>
  <files>Dispatch/Views/Skills/SkillsSidePanel.swift</files>
  <action>
1. Find and remove the terminal loading state variables:
   - `@State private var matchingTerminals: [TerminalWindow] = []`
   - `@State private var isLoadingTerminals = false`
   - Any other terminal window-related state

2. Remove the loadTerminals() method (around line 500)

3. Remove the loadTerminalsAsync() method (around lines 506-545):
   - This calls TerminalService.shared.getWindows()
   - Handles TerminalServiceError.permissionDenied and .accessibilityPermissionDenied
   - Sets showingAutomationPermissionAlert/showingAccessibilityPermissionAlert

4. Remove the `await loadTerminalsAsync()` call from onAppear (around line 94)

5. If there's UI that displays matchingTerminals, remove that section as well.

Why: Terminal.app window matching is obsolete. Embedded terminal uses active session targeting automatically.
  </action>
  <verify>
Build succeeds: `xcodebuild -scheme Dispatch -destination 'platform=macOS' build 2>&1 | tail -20`
No TerminalService: `grep -n "TerminalService" Dispatch/Views/Skills/SkillsSidePanel.swift`
No getWindows: `grep -n "getWindows" Dispatch/Views/Skills/SkillsSidePanel.swift`
  </verify>
  <done>
matchingTerminals state removed
loadTerminals/loadTerminalsAsync methods removed
TerminalService.shared.getWindows() call removed
No TerminalService references remain in SkillsSidePanel
  </done>
</task>

</tasks>

<verification>
- Build: `xcodebuild -scheme Dispatch -destination 'platform=macOS' build`
- No TerminalService: `grep -n "TerminalService" Dispatch/Views/Skills/SkillsSidePanel.swift` returns nothing
- No permission alerts: `grep -n "PermissionAlert" Dispatch/Views/Skills/SkillsSidePanel.swift` returns nothing
</verification>

<success_criteria>
- Terminal.app permission alerts removed
- Terminal window loading removed
- No TerminalService references in SkillsSidePanel
- App builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-migration-cleanup/22-06-SUMMARY.md`
</output>
